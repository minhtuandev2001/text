Escape hatches

TRONG CHÆ¯Æ NG NÃ€Y: 

1. CÃ¡ch "remember" thÃ´ng tin mÃ  khÃ´ng cáº§n re-render. (How to â€œrememberâ€ information without re-rendering)
2. CÃ¡ch truy cáº­p cÃ¡c pháº§n tá»­ DOM do React quáº£n lÃ½. (How to access DOM elements managed by React)
3. CÃ¡ch Ä‘á»“ng bá»™ hÃ³a cÃ¡c thÃ nh pháº§n vá»›i há»‡ thá»‘ng bÃªn ngoÃ i. (How to synchronize components with external systems)
4. CÃ¡ch xÃ³a cÃ¡c Effect khÃ´ng cáº§n thiáº¿t khá»i cÃ¡c thÃ nh pháº§n cá»§a báº¡n. (How to remove unnecessary Effects from your components)
5. VÃ²ng Ä‘á»i cá»§a Effect khÃ¡c vá»›i vÃ²ng Ä‘á»i cá»§a má»™t component nhÆ° tháº¿ nÃ o. (How an Effectâ€™s lifecycle is different from a componentâ€™s)
6. CÃ¡ch ngÄƒn má»™t sá»‘ giÃ¡ trá»‹ kÃ­ch hoáº¡t láº¡i Effect (How to prevent some values from re-triggering Effects)
7. CÃ¡ch lÃ m cho Effect cá»§a báº¡n cháº¡y láº¡i Ã­t thÆ°á»›ng xuyÃªn hÆ¡n. (How to make your Effect re-run less often)
8. CÃ¡ch chia sáº» Logic giá»¯a cÃ¡c component. (How to share logic between components)


/// Tham chiáº¿u giÃ¡ trá»‹ vá»›i refs (referencing value with refs)

: ghi nhá»› thÃ´ng tin nhÆ°ng khÃ´ng muá»‘n thÃ´ng tin Ä‘Ã³ kÃ­ch hoáº¡t láº¡i káº¿t xuáº¥t má»›i
	
	vd: const ref = useRef(0);

/// Thao tÃ¡c Dom vá»›i ref

: React tá»± Ä‘á»™ng cáº­p nháº­t Dom Ä‘á» phÃ¹ há»£p vá»›i Ä‘áº§u ra render cá»§a báº¡n, vÃ¬ váº­y cÃ¡c component cá»§a báº¡n sáº½ khÃ´ng cáº§n thao tÃ¡c vá»›i nÃ³ thÆ°á»ng
xuyÃªn. Tuy nhiÃªn, Ä‘Ã´i khii báº¡n cÃ³ thá»ƒ cáº§n quyá»n truy cáº­p vÃ o cÃ¡c pháº§n tá»­ Dom do react quáº£n lÃ½
	: vÃ­ dá»¥: Ä‘á»ƒ focus vÃ o node, cuá»™n tá»›i node, hoáº·c Ä‘o kÃ­ch thÆ°á»›c vÃ  vá»‹ trÃ­ node Ä‘Ã³. KhÃ´ng cÃ³ cÃ¡ch tÃ­ch há»£p nÃ o dá»ƒ thá»±c hiá»‡n nhá»¯ng 
Ä‘iá»ƒu Ä‘Ã³ trong React, vÃ¬ váº­y báº¡n sáº½ cáº§n tham chiáº¿u Ä‘áº¿n node Dom.
	: vÃ­ dá»¥ : nháº¥p vÃ o node sáº½ focus Ä‘áº§u vÃ o báº±ng cÃ¡ch dÃ¹ng ref

CODE :
import { useRef } from 'react';

export default function Form() {
  const inputRef = useRef(null);

  function handleClick() {
    inputRef.current.focus();
  }

  return (
    <>
      <input ref={inputRef} />
      <button onClick={handleClick}>
        Focus the input
      </button>
    </>
  );
}

/// Äá»“ng bá»™ hÃ³a vá»›i Effect (synchronizing with Effects)

: Má»™t sá»‘ component cáº§n pháº£i Ä‘á»“ng bá»™ hÃ³a vá»›i cÃ¡c há»‡ thá»‘ng bÃªn ngoÃ i. 
	: vÃ­ dá»¥: báº¡n cÃ³ thá»ƒ muá»‘n kiá»ƒm soÃ¡t má»™t thÃ nh pháº§n khÃ´ng pháº£i React, dá»±a trÃªn state react,
: Effect cho phÃ©p báº¡n cháº¡y má»™t sá»‘ mÃ£ sau khi káº¿t xuáº¥t. Sá»­ dá»¥ng chÃºng Ä‘á»ƒ Ä‘á»“ng bá»™ hÃ³a thÃ nh pháº§n cá»§a báº¡n vá»›i má»™t sá»‘ há»‡ thá»‘ng bÃªn ngoÃ i

VÃ Dá»¤: Nháº¥n Play/Pause nhiá»u láº§n vÃ  xem cÃ¡ch trÃ¬nh phÃ¡t video Ä‘Æ°á»£c Ä‘á»“ng bá»™ hÃ³a vá»›i props value isPlaying.
import { useState, useRef, useEffect } from 'react';

function VideoPlayer({ src, isPlaying }) {
  const ref = useRef(null);

  useEffect(() => {
    if (isPlaying) {
      ref.current.play();
    } else {
      ref.current.pause();
    }
  }, [isPlaying]);

  return <video ref={ref} src={src} loop  />;
}

export default function App() {
  const [isPlaying, setIsPlaying] = useState(false);
  return (
    <>
      <button onClick={() => setIsPlaying(!isPlaying)}>
        {isPlaying ? 'Pause' : 'Play'}
      </button>
      <VideoPlayer
        isPlaying={isPlaying}
        src="https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4"
      />
    </>
  );
}
--> Nhiá»u Effect cÅ©ng cáº§n pháº£i "clean up". vÃ­ dá»¥ (Effect cá»§a báº¡n thiáº¿t láº­p káº¿t ná»‘i vá»›i mÃ¡y chá»§, thÃ¬ sau Ä‘Ã³ pháº£i dá»n dáº¹p nÃ³ báº±ng cÃ¡ch 
ngáº¯t káº¿t ná»‘i thÃ nh pháº§n cá»§a báº¡n khá»i mÃ¡y)

import { useState, useEffect } from 'react';
import { createConnection } from './chat.js';

export default function ChatRoom() {
  useEffect(() => {
    const connection = createConnection();
    connection.connect();
    return () => connection.disconnect();
  }, []);
  return <h1>Welcome to the chat!</h1>;
}

--> trong quÃ¡ trÃ¬nh phÃ¡t triá»ƒn(DEV), React sáº½ ngay láº­p tá»©c cháº¡y vÃ  clean up Effect cá»§a báº¡n thÃªm má»™t láº§n ná»¯a. ÄÃ¢y lÃ  lÃ½ do táº¡i sao in 
ra 2 láº§n.

/// Báº¡n cÃ³ thá»ƒ khÃ´ng cáº§n Effect

: CÃ¡c Effect lÃ  má»™t lá»‘i thoÃ¡t khá»i mÃ´ hÃ¬nh React. chÃºng cho phÃ©p báº¡n "step uotside" React vÃ  Ä‘á»“ng bá»™ hÃ³a cÃ¡c thÃ nh pháº§n cá»§a báº¡n vá»›i má»™t
sá»‘ há»‡ thá»‘ng bÃªn ngoÃ i. Náº¿u khÃ´ng cÃ³ há»‡ thá»‘ng bÃªn ngoÃ i tham gia (vÃ­ dá»¥: náº¿u báº¡n muá»‘n cáº­p nháº­t tráº¡ng thÃ¡i cá»§a má»™t thÃ nh pháº§n khi má»™t sá»‘
Ä‘áº¡o cá»¥ hoáº·c tráº¡ng thÃ¡i thay Ä‘á»•i ), thÃ¬ báº¡n khÃ´ng cáº§n cÃ³ Effect. 

CÃ“ 2 TRÆ¯á»œNG Há»¢P PHá»” BIáº¾N MÃ€ Báº N KHÃ”NG Cáº¦N HIá»†U á»¨NG:

	- Báº¡n khÃ´ng cáº§n Effect Ä‘á»ƒ chuyá»ƒn Ä‘á»•i dá»¯ liá»‡u Ä‘á»ƒ hiá»ƒn thá»‹.
	- Báº¡n khÃ´ng cáº§n hiá»‡u á»©ng Ä‘á»ƒ xá»­ lÃ½ cÃ¡c sá»± kiá»‡n ngÆ°á»i dÃ¹ng.

VÃ Dá»¤ : báº¡n khÃ´ng cáº§n Hiá»‡u á»©ng Ä‘á»ƒ Ä‘iá»u chá»‰nh má»™t sá»‘ tráº¡ng thÃ¡i dá»±a trÃªn tráº¡ng thÃ¡i khÃ¡c: 

function Form() {
  const [firstName, setFirstName] = useState('Taylor');
  const [lastName, setLastName] = useState('Swift');

  // ğŸ”´ Avoid: redundant state and unnecessary Effect
  const [fullName, setFullName] = useState('');
  useEffect(() => {
    setFullName(firstName + ' ' + lastName);
  }, [firstName, lastName]);
  // ...
}

THAY VÃ€O ÄÃ“, HÃƒY TÃNH TOÃN NHIá»€U NHáº¤T CÃ“ THá»‚ TRONG KHI RENDER

function Form() {
  const [firstName, setFirstName] = useState('Taylor');
  const [lastName, setLastName] = useState('Swift');
  // âœ… Good: calculated during rendering
  const fullName = firstName + ' ' + lastName;
  // ...
}


==> TUY NHIÃŠN Báº N Cáº¦N EFFECT Äá»‚ Äá»’NG Bá»˜ HÃ“A Vá»šI CÃC Há»† THá»NG BÃŠN NGOÃ€I


/// VÃ’NG Äá»œI Cá»¦A CÃC REACTIVE EFFECT 

: CÃ¡c Effect cÃ³ vÃ²ng Ä‘á»i khÃ¡c vá»›i cÃ¡c thÃ nh pháº§n. CÃ¡c thÃ nh pháº§n cÃ³ thá»ƒ mount, update, unmount. Má»™t Effect chá»‰ cÃ³ thá»ƒ thá»±c hiá»‡n 2 viÃªv :
báº¯t Ä‘áº§u Ä‘á»“ng bá»™ hÃ³a ná»™i dung nÃ o Ä‘Ã³ vÃ  sau Ä‘Ã³ dá»«ng Ä‘á»“ng bá»™ hÃ³a ná»™i dung Ä‘Ã³. Chu ká»³ nÃ y cÃ³ thá»ƒ xáº£y ra nhiá»u láº§n náº¿u Effect cá»§a báº¡n phá»¥ thuá»™c
vÃ o props vÃ  state thay Ä‘á»•i theo thá»i gian.

/// TÃ¡ch cÃ¡c sá»± kiá»‡n khá»i Effect (váº«n Ä‘ang nghiÃªn cá»©u chÆ°a Ä‘Æ°a vÃ o Ä‘Ã¢u)
//. Loáº¡i bá» cÃ¡c phá»¥ thuá»™c Effect
Ä‘á»‘i sá»‘ thá»© 2 cá»§a Effect
// TÃ¡i sá»­ dá»¥ng logic vá»›i HÃ´k tÃ¹y chá»‰nh
: Táº¡o cÃ¡c Hook tÃ¹y chá»‰nh, káº¿t há»£p chÃºng láº¡i vá»›i nhau, truyá»n dá»¯ liá»‡u giá»¯a chÃºng vÃ  sá»­ dá»¥ng láº¡i chÃºng giá»¯a cÃ¡c component.
























